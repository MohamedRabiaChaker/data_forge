{
    "dag_id": "gsheet_to_postgres_pipeline",
    "description": "ETL pipeline to extract data from Google Sheets, normalize column names, and load to PostgreSQL",
    "schedule_interval": "@daily",
    "start_date": "2025-01-01",
    "catchup": false,
    "tags": ["etl", "gsheet", "postgres", "example"],
    "default_args": {
        "owner": "airflow",
        "retries": 2,
        "retry_delay_minutes": 5
    },
    "source": {
        "type": "gsheet",
        "gcp_conn_id": "google_cloud_default",
        "spreadsheet_id": "1eRY5tueWFAYzywBRw9GfpCTcl28Ay9yY_bsEnwAZH9s",
        "range_name": "employees!A1:N1000"
    },
    "transforms": [
        {
            "type": "normalize_columns",
            "lowercase": true,
            "replace_spaces": "_",
            "remove_special_chars": true
        },
        {
            "type": "validate_duplicate_ids",
            "id_columns": ["eeid"],
            "action": "fail",
            "log_duplicates": true
        }
    ],
    "destination": {
        "type": "postgres",
        "postgres_conn_id": "postgres_default",
        "schema": "public",
        "table_name": "imported_data",
        "write_mode": "historize",
        "create_table": true,
        "temp_table_threshold": 1000,
        "historization": {
            "enabled": true,
            "id_columns": ["eeid"],
            "hash_algorithm": "md5",
            "track_deletes": true
        }
    }
}
